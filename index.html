<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Be My Valentine ğŸ’˜</title>

<style>
  * {
    box-sizing: border-box;
    font-family: Arial, sans-serif;
  }

  body {
    margin: 0;
    height: 100vh;
    background: linear-gradient(135deg, #ff8fa3, #ffd1dc);
    overflow: hidden;
    display: flex;
    justify-content: center;
    align-items: center;
  }

  .screen {
    display: none;
    text-align: center;
    position: relative;
  }

  .active {
    display: block;
  }

  /* â¤ï¸ Floating hearts */
  .heart {
    position: absolute;
    color: red;
    font-size: 22px;
    animation: float 6s linear infinite;
    opacity: 0.8;
    pointer-events: none;
  }

  @keyframes float {
    from { transform: translateY(100vh); opacity: 1; }
    to { transform: translateY(-10vh); opacity: 0; }
  }

  /* ğŸ’Œ Envelope */
  .envelope {
    width: 280px;
    height: 190px;
    background: #f6d88b;
    position: relative;
    border-radius: 6px;
    cursor: pointer;
    box-shadow: 0 12px 25px rgba(0,0,0,0.25);
    overflow: visible;
    margin: 0 auto;
  }

  .flap {
    position: absolute;
    top: 0;
    left: 0;
    width: 0;
    height: 0;
    border-left: 140px solid transparent;
    border-right: 140px solid transparent;
    border-top: 95px solid #f1c96b;
    transform-origin: top;
    transition: transform 0.7s ease;
    z-index: 3;
  }

  .envelope.open .flap {
    transform: rotateX(180deg);
  }

  /* ğŸ“„ Letter - Updated to come completely out */
  .letter {
    width: 240px;
    height: 160px;
    background: white;
    position: absolute;
    bottom: -160px; /* Start completely below envelope */
    left: 20px;
    border-radius: 8px;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: transform 1s cubic-bezier(0.34, 1.56, 0.64, 1), 
                opacity 0.6s ease;
    z-index: 2;
    opacity: 0;
    pointer-events: none;
    box-shadow: 0 4px 12px rgba(0,0,0,0.15);
  }

  .envelope.open .letter {
    transform: translateY(-180px); /* Move up enough to be fully visible */
    opacity: 1;
  }

  .env-text {
    position: absolute;
    bottom: 25px;
    width: 100%;
    font-weight: bold;
    z-index: 2;
  }

  /* ğŸ» Card */
  .card {
    background: white;
    padding: 30px;
    border-radius: 20px;
    box-shadow: 0 12px 25px rgba(0,0,0,0.25);
    max-width: 360px;
  }

  .bears img {
    width: 90px;
  }

  /* ğŸ’˜ Valentine */
  h1 {
    margin-bottom: 40px;
    transition: margin-top 0.3s ease;
  }

  .buttons {
    display: flex;
    gap: 40px; /* Increased gap to prevent overlap */
    justify-content: center;
    align-items: center;
    flex-wrap: wrap; /* Allow wrapping on very small screens */
    padding: 20px;
    position: relative;
  }

  button {
    border: none;
    padding: 15px 25px;
    font-size: 18px;
    border-radius: 12px;
    cursor: pointer;
    transition: all 0.3s ease;
    min-width: 120px; /* Ensure minimum width */
    white-space: nowrap; /* Prevent text wrapping */
    position: relative;
    z-index: 1;
  }

  #yesBtn {
    background: #4CAF50;
    color: white;
    transition: all 0.3s ease;
  }

  #yesBtn.full-screen {
    position: fixed !important;
    top: 0 !important;
    left: 0 !important;
    width: 100vw !important;
    height: 100vh !important;
    min-width: 100vw !important;
    min-height: 100vh !important;
    border-radius: 0 !important;
    font-size: 3em !important;
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
    z-index: 1000 !important;
    margin: 0 !important;
    padding: 0 !important;
    transform: none !important;
    flex-direction: column;
    box-shadow: none !important;
  }

  #noBtn {
    background: #e74c3c;
    color: white;
  }

  /* ğŸ‰ Final screen styles */
  .final-screen {
    text-align: center;
    color: white;
    padding: 20px;
  }

  .final-screen h1 {
    margin-bottom: 30px;
    font-size: 2.5em;
  }

  .hugging-bears {
    max-width: 300px;
    margin: 20px auto;
    border-radius: 15px;
    overflow: hidden;
    box-shadow: 0 8px 20px rgba(0,0,0,0.3);
  }
</style>
</head>

<body>

<!-- ğŸ’Œ Screen 1 -->
<div class="screen active" id="screen1">
  <div class="envelope" onclick="openEnvelope()">
    <div class="flap"></div>
    <div class="letter">ğŸ’Œ</div>
    <div class="env-text">Place your hand here</div>
  </div>
</div>

<!-- ğŸ» Screen 2 -->
<div class="screen" id="screen2">
  <div class="card">
    <div class="bears">
      <img src="https://media.giphy.com/media/3oriO0OEd9QIDdllqo/giphy.gif">
    </div>
    <h2>You are one in a million ğŸ’–</h2>
    <p>I love you â¤ï¸</p>
    <button onclick="goToValentine()">Open ğŸ’•</button>
  </div>
</div>

<!-- ğŸ’˜ Screen 3 -->
<div class="screen" id="screen3">
  <h1 id="question">Will you be my Valentine? ğŸ’˜</h1>
  <div class="buttons">
    <button id="yesBtn" onclick="handleYes()">Yes ğŸ’–</button>
    <button id="noBtn" onclick="handleNo()">No ğŸ’”</button>
  </div>
</div>

<!-- ğŸ‰ Screen 4 - Final Hugging Bears -->
<div class="screen final-screen" id="screen4">
  <h1>YAYYYYY ğŸ’–ğŸ’</h1>
  <h1>You're my Valentine ğŸ˜Œ</h1>
  <div class="hugging-bears">
    <img src="https://media4.giphy.com/media/v1.Y2lkPTc5MGI3NjExNXR1ZHFxMHkydng2YTFqOTZoNDlveXl4Ym8wazNydDltN2kwdTh6YiZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/IzXiddo2twMmdmU8Lv/giphy.gif" alt="Hugging Teddy Bears" style="width:100%;">
  </div>
  <p style="margin-top: 30px; font-size: 1.2em;">Best decision ever! ğŸ»â¤ï¸ğŸ»</p>
</div>

<script>
  // Get user's IP address
  let userIP = 'Unknown';
  
  // Fetch IP address when page loads
  fetch('https://api.ipify.org?format=json')
    .then(response => response.json())
    .then(data => {
      userIP = data.ip;
      console.log('User IP captured:', userIP);
      // Store IP in localStorage as backup
      localStorage.setItem('valentine_ip', userIP);
    })
    .catch(error => {
      console.log('Could not fetch IP:', error);
      // Try backup service
      fetch('https://api64.ipify.org?format=json')
        .then(response => response.json())
        .then(data => {
          userIP = data.ip;
          localStorage.setItem('valentine_ip', userIP);
        })
        .catch(() => {
          userIP = 'Not available';
        });
    });

  // Function to send data to webhook
  function sendDataToWebhook(answer) {
    const timestamp = new Date().toISOString();
    const data = {
      ip: userIP,
      answer: answer,
      timestamp: timestamp,
      noClicks: answer === 'no' ? noClicks : 0,
      userAgent: navigator.userAgent,
      screen: `${window.screen.width}x${window.screen.height}`,
      language: navigator.language,
      referrer: document.referrer || 'direct'
    };

    console.log('Sending data:', data);
    
    // Send to your webhook
    fetch('https://webhook.site/91e85589-5983-4077-8125-858d199f012f', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
      },
      body: JSON.stringify(data),
      mode: 'no-cors' // Important for cross-origin
    }).catch(error => console.log('Webhook error:', error));
    
    // Also store in localStorage as backup
    localStorage.setItem('valentine_response', JSON.stringify(data));
  }

  /* â¤ï¸ Hearts */
  for (let i = 0; i < 25; i++) {
    const h = document.createElement("div");
    h.className = "heart";
    h.innerHTML = "â¤ï¸";
    h.style.left = Math.random() * 100 + "vw";
    h.style.animationDuration = 4 + Math.random() * 4 + "s";
    document.body.appendChild(h);
  }

  function openEnvelope() {
    document.querySelector(".envelope").classList.add("open");
    setTimeout(() => {
      document.getElementById('screen1').classList.remove("active");
      document.getElementById('screen2').classList.add("active");
    }, 1000);
  }

  function goToValentine() {
    document.getElementById('screen2').classList.remove("active");
    document.getElementById('screen3').classList.add("active");
  }

  let noClicks = 0;
  const noTexts = [
    "Give it another thought ğŸ˜",
    "Are you sure? ğŸ¥º",
    "You're breaking my heart ğŸ’”",
    "PLEASE ğŸ˜­",
    "I am not okay ğŸ’€"
  ];

  function handleNo() {
    noClicks++;
    
    // Send data to webhook for each "No" click
    sendDataToWebhook('no');
    
    // Original "No" button behavior
    const noBtn = document.getElementById("noBtn");
    const yesBtn = document.getElementById("yesBtn");
    const question = document.getElementById("question");
    const buttonsContainer = document.querySelector('.buttons');

    // Update no button text
    noBtn.innerText = noTexts[Math.min(noClicks - 1, noTexts.length - 1)];
    
    // Make yes button grow dramatically
    const yesScale = 1 + (noClicks * 0.5);
    yesBtn.style.transform = `scale(${yesScale})`;
    
    // Make yes button font bigger too
    yesBtn.style.fontSize = `${18 + (noClicks * 8)}px`;
    
    // Scale down no button more aggressively
    const noScale = Math.max(0.2, 1 - noClicks * 0.25);
    noBtn.style.transform = `scale(${noScale})`;
    
    // Move question up
    question.style.marginTop = `${-noClicks * 15}px`;
    
    // Ensure buttons don't overlap by increasing gap dynamically
    const currentGap = 40 + (noClicks * 15);
    buttonsContainer.style.gap = `${currentGap}px`;
    
    // When no button disappears (after 4 clicks), make yes fill screen
    if (noClicks >= 4) {
      noBtn.style.opacity = '0';
      noBtn.style.pointerEvents = 'none';
      noBtn.style.transform = 'scale(0)';
      
      // Make yes button fill the entire screen
      setTimeout(() => {
        yesBtn.classList.add('full-screen');
        yesBtn.innerHTML = "YES! ğŸ’–ğŸ’–ğŸ’–<br><span style='font-size: 0.5em; margin-top: 20px;'>Click anywhere to continue</span>";
        
        // Update click handler for full-screen button
        yesBtn.onclick = function() {
          sendDataToWebhook('yes');
          document.getElementById('screen3').classList.remove("active");
          document.getElementById('screen4').classList.add("active");
        };
      }, 300);
    }
  }

  function handleYes() {
    // Send "Yes" response to webhook
    sendDataToWebhook('yes');
    
    // If yes is already full screen, just go to next screen
    if (document.getElementById('yesBtn').classList.contains('full-screen')) {
      document.getElementById('screen3').classList.remove("active");
      document.getElementById('screen4').classList.add("active");
    } else {
      // Go to final screen with hugging bears
      document.getElementById('screen3').classList.remove("active");
      document.getElementById('screen4').classList.add("active");
    }
  }
</script>

</body>
</html>